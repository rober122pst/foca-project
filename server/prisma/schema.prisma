datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

model User {
    id           Int           @id @default(autoincrement())
    email        String        @unique
    name         String        @unique
    password     String
    role         String        @default("USER")
    isVerified   Boolean       @default(false)
    createdAt    DateTime      @default(now())
    updatedAt    DateTime      @updatedAt
    profile      Profile?
    config       Config?
    gamefication Gamefication?
    task         Task?
    routine      Routine?
}

enum Theme {
    DARK
    LIGHT
}

model Config {
    id       Int   @id @default(autoincrement())
    userId   Int   @unique
    user     User  @relation(fields: [userId], references: [id])
    theme    Theme @default(DARK)
    language Int   @default(1)
}

model Profile {
    id        Int    @id @default(autoincrement())
    userId    Int    @unique
    user      User   @relation(fields: [userId], references: [id])
    picUrl    String @default("")
    bannerUrl String @default("")
    bio       String @default("")
    followers Int    @default(0)
    following Int    @default(0)
}

model Gamefication {
    id            Int   @id @default(autoincrement())
    userId        Int   @unique
    user          User  @relation(fields: [userId], references: [id])
    level         Int   @default(1)
    xp            Int   @default(0)
    coins         Float @default(0)
    streakCurrent Int   @default(0)
    streakBest    Int   @default(0)
    meta          Json?
}

enum Priority {
    LOW
    MEDIUM
    HIGH
}

model Task {
    id       Int       @id @default(autoincrement())
    userId   Int       @unique
    user     User      @relation(fields: [userId], references: [id])
    title    String
    done     Boolean   @default(false)
    deadline DateTime?
    priority Priority  @default(LOW)
    tags     String[]
}

enum Frequency {
    N0
    N1
    N2
    N3
    N4
    N5
    N6
}

model Routine {
    id              Int         @id @default(autoincrement())
    userId          Int         @unique
    user            User        @relation(fields: [userId], references: [id])
    description     String
    frequency       Frequency[] @default([N0, N1, N2, N3, N4, N5, N6])
    timeStart       String
    timeEnd         String
    completedToday  Boolean     @default(false)
    completeDays    String
    lastCompletedAt DateTime
    createAt        DateTime    @default(now())
    updateAt        DateTime    @default(now())
}
